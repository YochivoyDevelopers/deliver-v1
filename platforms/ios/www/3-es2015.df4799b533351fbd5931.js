(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"+duN":function(t,n,o){"use strict";o.r(n),o.d(n,"InboxPageModule",(function(){return u}));var e=o("ofXK"),i=o("3Pt+"),s=o("TEn/"),c=o("tyNb"),r=o("fXoL"),a=o("CqG3"),l=o("H+bZ"),d=o("sYmb");const g=["scrollMe"],_=["messages"];function b(t,n){if(1&t&&(r.Ob(0,"div",13),r.Ob(1,"div",14),r.Ob(2,"div",15),r.pc(3),r.Nb(),r.Nb(),r.Mb(4,"div",16),r.Nb()),2&t){const t=r.Yb().$implicit;r.Ab(3),r.rc(" ",t.msg," ")}}function p(t,n){if(1&t&&(r.Ob(0,"div",17),r.Ob(1,"div",14),r.Ob(2,"div",15),r.pc(3),r.Nb(),r.Nb(),r.Mb(4,"div",18),r.Nb()),2&t){const t=r.Yb().$implicit;r.Ab(3),r.rc(" ",t.msg," ")}}function m(t,n){if(1&t&&(r.Ob(0,"span"),r.oc(1,b,5,1,"div",11),r.oc(2,p,5,1,"div",12),r.Nb()),2&t){const t=n.$implicit;r.Ab(1),r.dc("ngIf","user"==t.from),r.Ab(1),r.dc("ngIf","admin"==t.from)}}const h=[{path:"",component:(()=>{class t{constructor(t,n){this.adb=t,this.api=n,this.messages=[],this.count=0,this.id="admin"+localStorage.getItem("help"),this.getMessages(),this.adb.collection("users").doc(localStorage.getItem("help")).snapshotChanges().subscribe(t=>{this.api.getProfile(localStorage.getItem("help")).then(t=>{console.log(t),this.count=t&&t.count?t.count:0}).catch(t=>{console.log(t)})})}getMessages(){this.adb.collection("messages").doc(this.id).collection("chats").snapshotChanges().subscribe(t=>{console.log(t),this.api.getMessages(this.id).then(t=>{console.log(t),t.sort((t,n)=>new Date(t.timestamp).getTime()-new Date(n.timestamp).getTime()),this.messages=t,console.log("info",this.messages),this.scrollToBottomOnInit()}).catch(t=>{console.log(t)})},t=>{console.log(t)})}ngOnInit(){}send(){if(console.log("this.mess",this.message),this.message&&this.id){const t=this.message;this.message="",console.log("send");const n=Math.floor(1e8+9e8*Math.random()),o={msg:t,from:"user",timestamp:(new Date).toISOString(),id:this.id,docId:n};this.adb.collection("messages").doc(this.id).collection("chats").doc(n.toString()).set(o).then(t=>{console.log("sent",t)}).catch(t=>{console.log(t)});const e={count:this.count+1};this.api.updateProfile(localStorage.getItem("help"),e).then(t=>{console.log("updated",t)}).catch(t=>{console.log(t)})}}scrollToBottomOnInit(){try{this.myScrollContainer.nativeElement.scrollTop=this.myScrollContainer.nativeElement.scrollHeight}catch(t){}}}return t.\u0275fac=function(n){return new(n||t)(r.Lb(a.AngularFirestore),r.Lb(l.a))},t.\u0275cmp=r.Fb({type:t,selectors:[["app-inbox"]],viewQuery:function(t,n){var o;1&t&&(r.uc(g,!0),r.uc(_,!0)),2&t&&(r.hc(o=r.Xb())&&(n.myScrollContainer=o.first),r.hc(o=r.Xb())&&(n.messagesList=o))},decls:18,vars:9,consts:[["color","custom-red",1,"custom-toolbar"],["slot","start"],["color","light",1,"custom-tittle"],[1,"separador"],[1,"main_content_div"],[1,"lower_div",3,"scrollTop"],["scrollMe",""],[4,"ngFor","ngForOf"],[1,"footer_div"],["type","text",3,"ngModel","placeholder","ngModelChange"],["name","send-sharp",1,"send_btn",3,"click"],["class","main_div_right",4,"ngIf"],["class","main_div_left",4,"ngIf"],[1,"main_div_right"],[1,"msg_div"],[1,"inner_msg"],[1,"tri_right"],[1,"main_div_left"],[1,"tri_left"]],template:function(t,n){if(1&t&&(r.Ob(0,"ion-toolbar",0),r.Ob(1,"ion-buttons",1),r.Mb(2,"ion-back-button"),r.Nb(),r.Ob(3,"ion-title",2),r.pc(4),r.Zb(5,"translate"),r.Nb(),r.Nb(),r.Ob(6,"ion-content"),r.Ob(7,"div",3),r.Ob(8,"div",4),r.Ob(9,"div",5,6),r.oc(11,m,3,2,"span",7),r.Nb(),r.Nb(),r.Nb(),r.Nb(),r.Ob(12,"ion-footer"),r.Ob(13,"ion-toolbar"),r.Ob(14,"div",8),r.Ob(15,"ion-input",9),r.Wb("ngModelChange",(function(t){return n.message=t})),r.Zb(16,"translate"),r.Nb(),r.Ob(17,"ion-icon",10),r.Wb("click",(function(){return n.send()})),r.Nb(),r.Nb(),r.Nb(),r.Nb()),2&t){const t=r.ic(10);r.Ab(4),r.qc(r.ac(5,5,"Support")),r.Ab(5),r.dc("scrollTop",t.scrollHeight),r.Ab(2),r.dc("ngForOf",n.messages),r.Ab(4),r.ec("placeholder",r.ac(16,7,"Type a message...")),r.dc("ngModel",n.message)}},directives:[s.C,s.g,s.d,s.e,s.B,s.i,e.i,s.j,s.m,s.J,i.d,i.g,s.l,e.j],pipes:[d.c],styles:['ion-header[_ngcontent-%COMP%]{box-shadow:none}.custom-toolbar[_ngcontent-%COMP%]{border-radius:0 0 0 30px;background:red;color:#fff;clip-path:path("M 0 0 H 100% V calc(100% - 30px) Q 50% 100% 0 calc(100% - 30px) Z")}.custom-title[_ngcontent-%COMP%]{text-align:center;font-size:1.5rem;font-weight:700;text-transform:uppercase}.separador[_ngcontent-%COMP%]{background-color:red;height:30px}.main_content_div[_ngcontent-%COMP%]{padding-top:10px;border-radius:0 30px 0 0;width:100%;background:#fff;position:relative}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]{padding:0 20px}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .main_div_right[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:flex-end;position:relative}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .main_div_right[_ngcontent-%COMP%]   .msg_div[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;width:80%;margin-bottom:15px}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .main_div_right[_ngcontent-%COMP%]   .msg_div[_ngcontent-%COMP%]   .inner_msg[_ngcontent-%COMP%]{background-color:#f0eff5;padding:10px;border-radius:5px}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .main_div_right[_ngcontent-%COMP%]   .tri_right[_ngcontent-%COMP%]{width:0;height:0;position:absolute;border-top:10px solid #f0eff5;border-left:10px solid transparent;bottom:10px}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .main_div_left[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:flex-start;position:relative}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .main_div_left[_ngcontent-%COMP%]   .msg_div[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;width:80%;margin-bottom:15px}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .main_div_left[_ngcontent-%COMP%]   .msg_div[_ngcontent-%COMP%]   .inner_msg[_ngcontent-%COMP%]{background-color:var(--ion-color-red-msj);padding:10px;border-radius:5px;color:#fff}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .main_div_left[_ngcontent-%COMP%]   .tri_left[_ngcontent-%COMP%]{width:0;height:0;position:absolute;border-top:10px solid var(--ion-color-main2);border-right:10px solid transparent;bottom:10px}.footer_div[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;padding:20px}.footer_div[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background:#fdfdfd}.footer_div[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{border:1px solid #d3d3d3;border-radius:5px;--padding-start:8px;height:20px;height:35px}.footer_div[_ngcontent-%COMP%]   .send_btn[_ngcontent-%COMP%]{font-size:20px;color:var(--ion-color-main2);margin-left:10px}']}),t})()}];let f=(()=>{class t{}return t.\u0275mod=r.Jb({type:t}),t.\u0275inj=r.Ib({factory:function(n){return new(n||t)},imports:[[c.i.forChild(h)],c.i]}),t})(),u=(()=>{class t{}return t.\u0275mod=r.Jb({type:t}),t.\u0275inj=r.Ib({factory:function(n){return new(n||t)},imports:[[e.b,i.a,s.D,f,d.b]]}),t})()}}]);